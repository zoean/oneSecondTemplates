<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scaleable=no">
      <title><%= title %></title>
      <link rel="stylesheet" type="text/css" href="stylesheets/common/cpt/ablum_edit.css">
    <link rel="stylesheet" href="stylesheets/common/cpt/photo_animate.css">
      <link rel="stylesheet" href="stylesheets/temp_music/index_1004.css">
      <link rel="icon" href="favicon.ico">      
      <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
      <script src="javascripts/libs/flexible/flexible_css.js"></script>
      <script src="javascripts/libs/flexible/flexible.js"></script>
      <style>
        #bg_01{width:100%;height:100%;position: relative;}
        #bg-style-1{width: 100%;height: 100%;background: linear-gradient(to bottom right, #d963f8 , #f09f9b);position: absolute;top:0;left:0;z-index: 2;}
        #bg-style-1 span{width:100%;height: 100%;display: block;background:url('images/temp_music/temp5/decorate.png') no-repeat center;background-size: 100% 100%;}
        #bg-style-2{width:100%;height:100%;background: linear-gradient(to bottom right, #3f99ff , #61edfa);position: absolute;top:0;left:0;}
          #bg-style-2 span{width:100%;height:100%;display: block;background:url('images/temp_music/temp5/decorate_1.png') no-repeat center;background-size: 100% 100%;}
          #bg-style-3{width:100%;height:100%;background: linear-gradient(to bottom right, #7de6a4 , #ccec88);position: absolute;top:0;left:0;}
          #bg-style-3 span{width:100%;height:100%;display: block;background:url('images/temp_music/temp5/decorate_2.png') no-repeat center;background-size: 100% 100%;}
          .show{animation: show 1s linear 0s both;}
          .hide{animation: hide 1s linear 0s both;}
          @keyframes show {
              0%{opacity: 0;}
              100%{opacity: 1;}
          }
          @keyframes hide {
              0%{opacity: 1;}
              100%{opacity: 0;}
          }
          #bgMusic{position: absolute;}
        .photo{
            background:url('images/static.gif') no-repeat center;background-size: 100% 100%;
            border: 7px solid #fff;
            border-radius: 60px;
        }
      </style>
  </head>
  <body>    
    <audio id="bgMusic" autoplay="autoplay" src="<%= songUrl %>" loop="loop"></audio>
    <div id="bgMusicControl" class="bgMusicPlay"></div>
    <div class="tem_wrap">
        <div id="bg_01">
            <div id="bg-style-1">
                <span></span>
            </div>
            <div id="bg-style-2">
                <span></span>
            </div>
            <div id="bg-style-3">
                <span></span>
            </div>
        </div>
      <div class="animat_item">
        <div id="animat_photo">
          <ul long="<%= list.length %>">
            <li>
            	<span class="photo">
            		<img class="showimg" src="images/static.png" alt="" />
            	</span>
                <span class="photo">
            		<img class="showimg" src="images/static.png" alt="" />
            	</span>
            </li>
         </ul>
        </div>
          <ul id="saveImgSrc"  style="display: none;">
          </ul>
        <div class="animat_crane">

        </div>
          <div id="loadimgWrap" style="display: none;">
              <img  alt="">
              <img  alt="">
          </div>
      </div>
        <div style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;">

        </div>
      <!-- <ul id="albumEdit">
        <li><span>模板</span></li> 
        <li><span>音乐</span></li> 
        <li><span>添加</span></li> 
        <li><span>保存</span></li> 
      </ul> -->
      <!-- <div id="editTemp" class="editItem">
        <s class="close"></s>
        <div id="tempWrap">
          <ul>
            <li class="cur">
              <img src="img/images/temp1.png" alt="">
              <p>复古相册</p>
            </li>
            <li>
              <img src="img/images/temp2.png" alt="">
              <p>梅花三弄</p>
            </li>
            <li>
              <img src="img/images/temp1.png" alt="">
              <p>复古相册</p>
            </li>
            <li>
              <img src="img/images/temp2.png" alt="">
              <p>梅花三弄</p>
            </li>
            <li>
              <img src="img/images/temp1.png" alt="">
              <p>复古相册</p>
            </li>
            <li>
              <img src="img/images/temp2.png" alt="">
              <p>梅花三弄</p>
            </li>
            <li>
              <img src="img/images/temp1.png" alt="">
              <p>复古相册</p>
            </li>
            <li>
              <img src="img/images/temp2.png" alt="">
              <p>梅花三弄</p>
            </li>
          </ul>
        </div>        
      </div>
      <div id="editMusic" class="editItem">
        <s class="close"></s>
        <div id="musicWrap">
          <ul>
            <li class="cur">
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>红楼一梦</h3>
              <p>鲁巴</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>红楼一梦</h3>
              <p>鲁巴</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
            <li>
              <h3>一朵云在蓝天飘过</h3>
              <p>乌兰马托</p>
            </li>
          </ul>
        </div>        
      </div> -->
    </div>       
  </body>
  <script>
      //保存当前相册选择的音乐id和模板信息
      var selectTemplateId = "<%= templateId%>";
      var selectSongId = "<%= songId%>";
      var albumType = "<%= postType%>";
      var tempId = "<%= id%>";
  </script>
  <script src="javascripts/libs/jquery-3.3.1.min.js"></script>
  <script src="javascripts/libs/zepto/zepto.min-1.2.0.js"></script>
  <script src="javascripts/libs/zepto/fastclick.js"></script>
  <script src="javascripts/libs/zepto/fx.js"></script>
  <script src="javascripts/libs/zepto/touch.js"></script>
  <script src="javascripts/common/mod/queryString.js"></script>
  <script src="javascripts/common/mod/subString.js"></script>
  <script src="javascripts/common/cpt/index.js"></script>
  <script type="text/javascript" src="javascripts/common/cpt/albumTemEdit.js"></script>
  <script>
    wx.miniProgram.getEnv(function(res) {
     console.log(res.miniprogram); // true 
   })
    var app = window.app || {};
    function RandomNumBoth(Min,Max){
        var Range = Max - Min;
        var Rand = Math.random();
        var num = Min + Math.round(Rand * Range); //四舍五入
        return num;
    }
    app.init = function(){
        var bgChange = $('#bg_01').find('div');
        var changeIndex = 1;
        function changeBg(){
            bgChange.attr('class','hide');
            bgChange.eq(changeIndex).attr('class','').addClass('show');
            changeIndex++;
            if(changeIndex == 3){
                changeIndex = 0
            }
        }
        bgChange.eq(0).attr('class','').addClass('show');
        setInterval(function(){
            changeBg()
        },4000)
    }


    window.onload = function(){
//		    var sun = document.getElementById('sun');
//		    var rightTop = document.getElementById('flower-rightTop');
//            sun.addEventListener('webkitAnimationEnd', function(){
//                sun.classList.remove('sunstart');
//                sun.classList.add('sunrotate')
//			});
//            rightTop.addEventListener('webkitAnimationEnd',function(){
//                rightTop.classList.remove('rightTopStart');
//                rightTop.classList.add('rightTopEnd')
//			});
        app.init()
        //图片没有下载完成前，先显示默认图片
//        var imgload = $('.hideImg');
//        var imgshow = $('.showimg');
//        console.log(imgload);
//        var successLoadImg = 0;//保存下载成功图片的数量
//        var i = 0
//        var testImgLoad = function(){
//            if(i == imgload.length){
//                i = 0
//            }
//            if(imgload[i].complete){
//                console.log(imgload[i].complete)
//                imgshow[i].src = imgload[i].src;
//                successLoadImg ++
//                i++
//                console.log('保存下载成功图片的数量'+successLoadImg);
//                if(successLoadImg < imgload.length){
//                    testImgLoad()
//                }
//            }else{
//                i++
//                if(successLoadImg < imgload.length){
//                    testImgLoad()
//                }
//            }
//        }
//        testImgLoad();
        //图片没有下载完成前，先显示默认图片
    }
    document.addEventListener('DOMContentLoaded', function () {
        function audioAutoPlay() {
            var audio = document.getElementById('bgMusic');
            audio.play();
            document.addEventListener("WeixinJSBridgeReady", function () {
                audio.play();
            }, false);
        }
        audioAutoPlay();
    });
  </script>
</html>